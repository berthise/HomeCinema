<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
    xmlns:ez="http://xmlns.jcp.org/jsf/composite/ezcomp">
    <h:head>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
	<title></title>
	<meta name="description" content=""/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>

	<link rel="stylesheet" href="css/bootstrap.min.css"/>
	<link rel="stylesheet" href="css/bootstrap-theme.min.css"/>
	<link rel="stylesheet" href="css/main.css"/>

	<f:metadata>
	    <f:viewParam name="box" value="#{accountManagedBean.initBox}" />
	    <f:event type="preRenderView" listener="#{loginManagedBean.checkConnected()}"/>
	    <f:event type="preRenderView" listener="#{accountManagedBean.setIdUser(loginManagedBean.id)}"/>
	</f:metadata>

    </h:head>
    <h:body id="top">
	<ui:insert name="header" >
	    <ui:include src="components/header.xhtml" />
	</ui:insert>
	<ui:param name="active" value="moncompte" />
	<section>
	    <div class="container">
		<div class="well">
		    <h2 class="well-title">Mon compte</h2>

		    <script>
			function display(id) {
			    document.getElementById('box-films').className = "display-none";
			    document.getElementById('link-films').className = "";
			    document.getElementById('box-caddie').className = "display-none";
			    document.getElementById('link-caddie').className = "";
			    document.getElementById('box-historique').className = "display-none";
			    document.getElementById('link-historique').className = "";
			    document.getElementById('box-infos').className = "display-none";
			    document.getElementById('link-infos').className = "";
			    document.getElementById('box-' + id).className = "box-right";
			    document.getElementById('link-' + id).className = "activated";
			    return false;
			}
		    </script> 

		    <div id="nav">
			<h:outputText value="#{accountManagedBean.getHtmlForLink('films', 'Mes films')}" escape="false" />
			<h:outputText value="#{accountManagedBean.getHtmlForLink('caddie', 'Mon Caddie')}" escape="false" />
			<h:outputText value="#{accountManagedBean.getHtmlForLink('historique', 'Mon historique')}" escape="false" />
			<h:outputText value="#{accountManagedBean.getHtmlForLink('infos', 'Mes informations')}" escape="false" />
		    </div>

		    <div class="#{accountManagedBean.getClassDisplay('films')}" id="box-films">
			<h3><img src="img/film-icon.png" title="Caddie"/>Films</h3>

			<table>

			    <ui:repeat var="o" value="#{accountManagedBean.getListFilms()}" varStatus="status">

				<c:set var="simple" value="#{o.get(0) eq 'SIMPLE'}" />
				<c:set var="vide" value="#{o.get(0) eq 'EMPTY'}" />

				<tr>

				    <h:panelGroup rendered="#{vide}">
					<td>Votre liste de films est vide ... <a href="#">Cliquez ici pour trouver des films !</a></td>                                        
				    </h:panelGroup>

				    <h:panelGroup rendered="#{simple}">
					<td>
					    <span class="affiche">
						<img src="img/glass.png" />
						<span>
						    <img src="http://image.tmdb.org/t/p/w396/#{o.get(1)}" />
						</span>
					    </span>
					</td>
					<td>                 
					    <a title="Voir la fiche du film" href="fiche_film.xhtml?id=#{o.get(4)}">#{o.get(2)} (#{o.get(3)})</a>
					</td>
					<td><a href="visionneuse.xhtml?id=#{o.get(4)}"><img src="img/eye.png" title="Voir le film" /></a></td>
				    </h:panelGroup>

				</tr>

			    </ui:repeat>

			</table>
		    </div>

		    <div class="#{accountManagedBean.getClassDisplay('caddie')}" id="box-caddie">
			<ez:caddie title="Caddie" userId="#{loginManagedBean.id}" recap="false"/>
		    </div>

		    <div class="#{accountManagedBean.getClassDisplay('historique')}" id="box-historique">
			<h3><img src="img/clock-icon.png" title="Caddie"/>Historique</h3>
		    </div>

		    <div class="#{accountManagedBean.getClassDisplay('infos')}" id="box-infos">
			<h3><img src="img/info-icon.png" title="Caddie"/>Informations</h3>
		    </div>

		    <div id="bottom">
			<a class="go-top" href="#top" title="Vers le haut"><img src="img/arrowUp.png" /></a>                        
		    </div>                        
		</div>

	    </div>
	</section>
	<ui:insert name="footer" >
	    <ui:include src="components/footer.xhtml" />
	</ui:insert>
    </h:body>
</html>
